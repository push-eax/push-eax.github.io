<!doctype html>
<html lang="en" itemscope itemtype="http://schema.org/Person">
<head>
  <meta charset="utf-8">
  <!-- Site Meta Data -->
  <title> kiernanro.ch  | mvpower_exec Metasploit module</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="kroche">

  <link rel="shortcut icon" href="">

  <!-- schema.org -->
  <meta itemprop="name" content="kiernanro.ch">
  <meta itemprop="image" content="">
  <meta itemprop="description" content="">

  <link rel="stylesheet" href="/theme/css/style.css" type="text/css" />
  <!-- Feed Meta Data -->
    <link href="/" type="application/atom+xml" rel="alternate" title="kiernanro.ch RSS Feed" />

  <!-- Twitter Feed -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="">
  <meta name="twitter:image" content="">

</head>

<body>
    <div class="container">

    <!-- Navbar -->
      <div class="navbar">
        <h2>kiernanro.ch</h2>
        <ul class="static-item">
                <li><a href="/"><h4>home</h4></a></li>
                <li><a href="/archives.html"><h4>archives</h4></a></li>

                <li><a href="/pages/about.html"><h4>about</h4></a></li>
        </ul>        

        <span>
                    <a href="mailto:self@kiernanro.ch" target="_blank">
                        <img src="/theme/images/icons/mail.png">
                    </a>
                    <a href="https://www.linkedin.com/in/kiernan-roche" target="_blank">
                        <img src="/theme/images/icons/linkedin.png">
                    </a>
                    <a href="https://github.com/push-eax" target="_blank">
                        <img src="/theme/images/icons/github.png">
                    </a>
                    <a href="https://pgp.mit.edu/pks/lookup?op=get&search=0x221F2D628FE93562" target="_blank">
                        <img src="/theme/images/icons/pgp.png">
                    </a>
   
            <a href="/feed/rss" rel="alternate">
                <img src="/theme/images/icons/rss.png"></a>
        </span>
      </div>

    <maincontent>
<article>
<h2>mvpower_exec Metasploit module</h2>

<div>
Wed 01 February 2017 by <a href="/author/kroche.html">kroche</a> in <a href="/category/programs-and-tools.html" rel="bookmark" title="permalink to Programs and Tools">Programs and Tools</a>
    <hr>
</div>

<div>
    <mainarticle>
    <p>Pentest Partners, a UK-based security firm, <a href="https://www.pentestpartners.com/blog/pwning-cctv-cameras/">published</a> several vulnerabilites found in ARM-based MVPower brand DVRs last year, most notably an unauthenticated root shell exposed through the DVR's web interface. It appears that this is not a bug, but rather an intended feature, and that no firmware updates will be issued to disable it or allow users the option to do so.</p>
<p>This glaring security hole is part of a larger phenomenon of poor IoT security. Backdoors such as these make DVRs and other embedded devices popular targets and create pathways into larger networks for hackers.</p>
<p>A <a href="https://www.shodan.io/search?query=JAWS%2F1.0">Shodan query</a> returns over 35,000 DVRs exposing this shell:</p>
<p><a href="/images/shodan_query.png"><img alt="Shodan query" src="/images/shodan_query.png"></a></p>
<p>The shell is accessible by submitting a command in the format:</p>
<div class="highlight"><pre><span></span>http://vulnerable.dvr/shell?COMMAND
</pre></div>


<p>Commands need to be URL encoded to be properly interpreted.</p>
<p>The shell is non-interactive. Pentest Partners outlined this process to escalate to an interactive shell:</p>
<ol>
<li>Compile or script a reverse shell. Since we're dealing with devices which are usually situated behind NATs, 80 is the only exposed (forwarded) port, making bind shells unfeasible.</li>
<li>Use wget (included in the DVR's busybox) to fetch the payload and write it to /root/rec/a1, the directory where recorded video is stored and one of the few writable locations on the filesystem.</li>
<li>Execute the payload.</li>
</ol>
<p>I've written a Metasploit module (mvpower_exec) which automates the above process. Though it inherits from the Msf::Exploit::Remote class, it's not actually an exploit since it doesn't abuse a vulnerability to execute code (but I suppose that depends on whether an intended feature can be considered a vulnerability).</p>
<p>mvpower_exec delivers and executes payloads in a single HTTP request. It has been successfully tested with all Metasploit armle payloads except meterpreter (mettle). It also supports check.</p>
<p><a href="/images/exploit.png"><img alt="mvpower_exec in action" src="/images/exploit.png"></a></p>
<p><a href="/images/session.png"><img alt="Interacting with session" src="/images/session.png"></a></p>
<p>The module is available <a href="https://github.com/push-eax/mvpower_exec">here</a>.</p>
    </mainarticle>
</div>
<hr>
    Tags:
            <span>None</span>
</article>
    </maincontent>
  </div>
</body>

</html>